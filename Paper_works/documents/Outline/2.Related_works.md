x`# 2. Related Works

## 2.1 Unified Multi-class Anomaly Detection

### Paradigm Shift to Unified Models

초기의 이상 탐지 연구들은 제품 클래스(예: 나사, 병)마다 개별 모델을 학습시키는 One-Class Setting에 집중했으나, 이는 다품종 생산 현장에서의 관리 비용을 급증시켰다. 이에 따라 UniAD [You et al., NeurIPS 2022]와 OmniAL [Zhao, CVPR 2023]를 기점으로, 단일 모델로 여러 클래스를 동시에 학습하는 Unified (Multi-class) AD 패러다임으로 전환되었다. 최근에는 MambaAD [He et al., NeurIPS 2024]가 State Space Model을 활용하고, DiAD [He et al., AAAI 2024]와 LafitE [Yin et al., arXiv 2023]가 Diffusion 기반 접근법을 시도하는 등 다양한 아키텍처가 제안되고 있다.

### Challenges: Interference & Identity Mapping

그러나 단일 모델이 상이한 데이터 분포를 동시에 학습할 때, 클래스 간 특징이 충돌하는 Inter-class Interference 문제가 발생한다 [Jiang et al., arXiv 2024]. 특히 Reconstruction 기반 모델들은 이상(Anomaly)까지 그대로 복원해버리는 Identity Mapping 문제에 취약하며, 이를 해결하기 위해 DecAD [Wang et al., ICCV 2025]는 복잡한 대조 학습을, Revitalizing Reconstruction [Fan et al., arXiv 2024]은 Latent Disentanglement를 필요로 한다.

### Why Normalizing Flows?

Reconstruction 기반 모델과 달리, Normalizing Flow (NF)는 입력을 재구성하지 않고 우도(Likelihood)를 직접 최적화하므로 Identity Mapping 문제를 구조적으로 회피한다. 이러한 특성은 Dinomaly [Guo et al., CVPR 2025]의 "Less is More" 철학에 부합하며, 복잡한 보조 태스크 없이도 명확한 이상 탐지를 가능케 한다.

NF 기반 이상 탐지 연구는 DifferNet [Rudolph et al., WACV 2021]을 시작으로 활발히 진행되어 왔다. CFLOW-AD [Gudovskiy et al., WACV 2022]는 위치 조건부 NF를 도입하여 공간적 맥락을 효과적으로 활용하였고, FastFlow [Yu et al., arXiv 2021]는 2D 합성곱 기반의 효율적인 흐름 구조를 제안하여 실시간 처리를 가능케 하였다. 최근 MSFlow [Zhou et al., TNNLS 2024]는 다중 스케일 흐름을 통해 다양한 크기의 이상을 효과적으로 탐지하며 state-of-the-art 성능을 달성하였다. 이러한 연구들은 NF가 이상 탐지에 효과적인 프레임워크임을 입증하였다.

### Overcoming Multi-modal Constraints

그러나 초기 NF 모델들 역시 다중 클래스를 단일 정규 분포 $\mathcal{N}(0, I)$로 강제 매핑하여 클래스 간 분포 중첩(Overlap) 문제를 겪었다. 최신 연구들은 이를 구조적 고도화를 통해 해결하고 있다. HGAD [Yao et al., ECCV 2024]는 잠재 공간을 계층적 GMM으로 모델링하여 클래스별 분포를 확률적으로 분리함으로써 간섭을 구조적으로 방지했다. 한편, VQ-Flow [Zhou et al., arXiv 2024]는 계층적 벡터 양자화(Hierarchical Vector Quantization)를 도입하여 멀티 모달 특성을 이산적 코드북(Discrete Codebook)에 정교하게 매핑함으로써 NF의 효용성을 확장하였다.

### Limitation: Structural Rigidity

하지만 HGAD의 GMM 컴포넌트 수나 VQ-Flow의 코드북 크기는 학습 초기에 고정된다. 새로운 태스크가 기존 구조로 표현 불가능한 이질적인 분포를 가질 경우, 구조 전체를 재설계하지 않는 한 구조적 불일치(Structural Mismatch)가 발생한다. 이 불일치를 해소하기 위해 공유 구조를 강제로 업데이트하면, 이전 태스크를 지지하던 핵심 파라미터가 덮어씌워져 파멸적 망각(Catastrophic Forgetting)이 발생한다.

이러한 구조적 경직성은 사전에 정의된 고정 용량 내에서만 클래스를 수용할 수 있다는 근본적인 한계를 드러낸다. 실제 산업 환경에서는 새로운 제품군이 지속적으로 추가되므로, 모델이 기존 지식을 보존하면서 새로운 분포를 유연하게 학습할 수 있는 능력이 필수적이다. 이러한 요구는 자연스럽게 지속적 학습(Continual Learning) 패러다임으로의 전환을 요청한다.

---

## 2.2 Continual Learning: From Trade-off to Structural Decoupling

### The Stability-Plasticity Dilemma

지속적 학습(Continual Learning)은 데이터가 순차적으로 유입되는 비정상(Non-stationary) 환경에서, 새로운 지식을 학습하는 가소성(Plasticity)과 이전 지식을 보존하는 안정성(Stability) 사이의 본질적인 딜레마(Stability-Plasticity Dilemma)를 다룬다 [McCloskey & Cohen, 1989; French, 1999]. 앞 절에서 논의한 Unified AD 모델들의 구조적 경직성, 즉 새로운 클래스를 수용하기 위해 기존 파라미터를 변경하면 이전 지식이 훼손되는 문제는 바로 이 딜레마의 전형적인 발현이다.

### Limitations of Traditional Approaches

초기 연구들은 이 딜레마를 '균형'의 관점에서 접근하여 불완전한 Trade-off를 시도했다. Replay 기반 방법론은 과거 데이터를 저장하여 안정성을 확보하려 했으나, 메모리 제약 및 프라이버시 문제로 인해 새로운 데이터를 수용할 버퍼가 부족해져 가소성이 제한된다. 이와 달리, Regularization 기반 방법론인 EWC [Kirkpatrick et al., PNAS 2017]는 중요 파라미터의 변화를 억제하여 안정성을 높였으나, 이는 모델의 학습 능력을 저해하여 가소성을 희생시키는 결과를 낳는다.

### Paradigm Shift: Structural Isolation & PEFT

최근에는 파라미터 효율적 미세조정(Parameter-Efficient Fine-Tuning, PEFT)을 통해 딜레마를 타협이 아닌 구조적 분리(Structural Decoupling)로 해결하려는 시도가 주류를 이룬다. 특히 LoRA (Low-Rank Adaptation) [Hu et al., ICLR 2022]는 사전학습된 가중치를 동결한 채 저차원 행렬의 곱으로 태스크별 적응을 수행하여, 기존 지식의 보존과 새로운 지식의 학습을 구조적으로 분리하는 효율적인 방법을 제시하였다.

이러한 PEFT 기반 접근법은 다양한 방향으로 발전하고 있다. 모듈형 전문가 구조 측면에서, GainLoRA [Liang et al., arXiv 2025]와 MINGLE [Qiu et al., NeurIPS 2025]은 태스크별 LoRA 모듈(Plasticity)과 게이팅 네트워크를 결합한 전문가 혼합(Mixture of Experts) 구조를 통해 간섭 없는 지식 확장을 구현했다. 한편, 기하학적 및 인과적 제약 관점에서 AnaCP [NeurIPS 2025]는 기하학적 구조 보존을 통해 학습 간 간섭을 차단하며, CaLoRA [NeurIPS 2025]는 인과적 추론을 통해 과거 지식을 강화하는 후방 전이(Backward Transfer)까지 달성했다. 또한 동적 부분공간 할당 방식으로 CoSO [Cheng et al., NeurIPS 2025]는 학습 중 중요한 부분공간을 동적으로 할당하여 효율적인 가소성을 확보했다.

### Gap: Decision Boundary vs. Density Manifold

이러한 PEFT 기법들은 분류 모델에서는 효과적이었으나, AD 태스크에는 본질적인 한계가 존재한다. 분류 모델은 결정 경계(Decision Boundary)만 유지된다면 파라미터의 미세한 변화(Drift)에도 강건하다. 그러나 NF는 정상 데이터의 확률 밀도(Probability Density) 자체를 정밀하게 모델링해야 하는 생성적 특성을 가진다. NF의 핵심인 가역적 매핑(Bijective Mapping)은 파라미터 변화에 매우 민감하여, 단순한 Adapter 삽입만으로도 우도 매니폴드(Likelihood Manifold) 전체가 붕괴될 수 있다. 따라서 NF의 가역성을 보존하면서 파라미터를 격리하는 새로운 방법론이 요구된다.

---

## 2.3 Continual Learning in Anomaly Detection

앞서 논의한 일반적인 CL 기법들의 한계를 극복하기 위해, 이상 탐지(AD) 도메인에 특화된 다양한 방법론들이 제안되었다. 이들은 크게 Replay 기반, Regularization 기반, 그리고 동적 아키텍처 기반으로 분류할 수 있다.

### Replay-based Approaches

Replay 기반 접근법은 과거 태스크의 데이터를 저장하거나 생성하여 재학습에 활용한다. CADIC [Yang et al., arXiv 2025]은 대표적인 정상 샘플을 코어셋으로 저장하여 이전 지식을 보존하고자 하였다. 한편 ReplayCAD [Hu et al., IJCAI 2025]와 CDAD [Li et al., CVPR 2025]는 생성 모델을 활용하여 과거 데이터를 합성함으로써 저장 공간의 제약을 완화하고자 하였다. 그러나 이러한 접근법들은 근본적인 한계를 가진다. 생성 모델이 만들어내는 샘플의 '충실도 환각'이나 코어셋의 제한된 용량은 정상 데이터의 꼬리 분포(Tail Distribution)를 정밀하게 복원하지 못하며, 이는 밀도 추정 기반 이상 탐지의 정확도를 저하시킨다.

### Regularization & Distillation Approaches

Regularization 및 지식 증류 기반 접근법은 과거 데이터 대신 모델의 중요 파라미터나 출력 분포를 보존하고자 한다. DNE [Li et al., 2022]는 이전 태스크의 통계량만을 저장하여 메모리 효율성을 높였으며, CFRDC [Neural Networks 2024]는 문맥 인지 제약(Context-aware Constraint)을 통해 태스크 간 간섭을 완화하였다. 그러나 이들 방법은 데이터 분포를 단순한 가우시안으로 가정하거나 파라미터 유연성을 과도하게 제약하는 경향이 있다. 이러한 특성은 복잡한 비선형 변환이 필수적인 NF 구조에 적합하지 않으며, 특히 다양한 텍스처와 구조를 가진 산업 제품의 정상 분포를 정밀하게 모델링하는 데 한계를 보인다.

### Dynamic Architecture & Prompting

동적 아키텍처 기반 접근법은 태스크마다 별도의 모델 구성요소를 할당하여 간섭을 원천 차단하고자 한다. SurpriseNet [arXiv 2023]은 완전 격리 방식을 통해 태스크 간 간섭을 완벽히 방지하였으나, 태스크 수에 비례하여 모델 크기가 선형적으로 증가하는 비효율성을 수반한다. 이와 달리 UCAD [Liu et al., AAAI 2024] 등의 프롬프트 기반 방식은 입력 특징에 태스크별 오프셋(Offset)을 추가하여 파라미터 효율성을 확보하였다. 그러나 이러한 오프셋은 NF가 학습한 정상 분포의 지지 영역(Support)을 이동시키며, 새로운 프롬프트가 이전 태스크의 영역과 중첩될 경우 밀도 추정의 일관성을 저해할 수 있다.

### The Missing Piece: Task-Agnostic Routing

위에서 논의한 방법론들은 추론 시점에 입력 이미지의 제품 클래스(Task ID)가 주어진다는 가정 하에 설계되었다. 그러나 실제 산업 환경에서는 이러한 정보가 제공되지 않는 경우가 빈번하다. 기존 연구들은 Oracle Task ID를 가정하거나 별도의 분류기를 학습하여 이 문제를 우회하였으나, AD에서는 정상 데이터만으로 학습하므로 분류기의 일반화 성능을 보장하기 어렵다. 특히 이상 샘플이 정상과 유사한 외관을 가질 경우, 분류기가 잘못된 전문가를 선택하여 탐지 성능이 급격히 저하될 수 있다. 따라서 정상 데이터의 분포 특성만으로 적절한 전문가를 선택할 수 있는 Task-Agnostic Routing 메커니즘이 필수적이다.

---

## Conclusion

결론적으로, 현존하는 Continual AD 방법들은 다음 네 가지 요구사항을 동시에 충족하지 못한다: (1) Replay 없이 데이터 프라이버시를 보존할 것, (2) 복잡한 정상 분포를 정밀하게 모델링할 수 있는 밀도 추정 능력을 갖출 것, (3) 태스크 수 증가에도 파라미터 효율성을 유지할 것, 그리고 (4) 추론 시점에 Task ID 없이도 적절한 전문가를 선택할 수 있을 것.

본 연구에서 제안하는 MoLE-Flow는 이러한 네 가지 요구사항을 다음과 같이 해결한다. 첫째, NF의 coupling layer 내부에 태스크별 LoRA 어댑터를 삽입하여, 과거 데이터 없이도 이전 태스크의 밀도 매니폴드를 완벽히 보존한다 (요구사항 1, 2). 둘째, 저차원 행렬만을 추가하는 LoRA의 특성상, 태스크당 약 0.3%의 파라미터만 증가하여 높은 효율성을 달성한다 (요구사항 3). 셋째, 정상 데이터의 특징 분포를 프로토타입으로 저장하고 Mahalanobis 거리 기반으로 라우팅하여, 추론 시점에 Task ID 없이도 적절한 전문가를 선택한다 (요구사항 4). 이를 통해 MoLE-Flow는 Stability-Plasticity Dilemma를 타협이 아닌 구조적 분리로 해결하며, NF 기반 Continual AD의 새로운 패러다임을 제시한다.
